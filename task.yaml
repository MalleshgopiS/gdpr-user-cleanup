name: gdpr-user-cleanup
difficulty: hard
category: databases
description: |
  The "Bleater" platform is failing GDPR audits. When a user is deleted, "ghost data" remains across the architecture.

  Requirements for USER_ID 'user123':
  1. Delete Auth-DB record (PostgreSQL).
  2. Anonymize Posts (PostgreSQL): Change author_id to 'deleted_user' and redact PII content (replace user ID with '[REDACTED]').
  3. Delete Profile document (MongoDB).
  4. Delete Session key (Redis).
  5. Delete Avatar object (MinIO).
  6. Ensure the script is idempotent.

  Database Details:
  - Auth DB: host `auth-db`, db `auth_db`, table `users(id, email)`
  - Bleat DB: host `bleat-db`, db `bleat_db`, table `posts(author_id, content)`
  - MongoDB: host `mongo`, db `bleater`, collection `profiles`
  - Redis: host `redis`, key `session:<USER_ID>`
  - MinIO: host `http://minio:9000`, bucket `avatars`, object `<USER_ID>.png`
  - MinIO Credentials: user `minioadmin`, pass `minioadmin`