name: gdpr-user-cleanup
difficulty: hard

description: |
  Implement a GDPR "Right to be Forgotten" cleanup pipeline.

  Target user:
      USER_ID = user123

  Requirements:

  1. Delete auth-db record.
  2. Delete MongoDB profile document.
  3. Delete Redis session key.
  4. Delete MinIO avatar object.
  5. Posts MUST remain but be anonymized:
       - author_id MUST become 'deleted_user'
       - content MUST NOT contain USER_ID
  6. Script must be idempotent.

  ------------------------------------------------

  Database Schemas:

  auth_db.users:
      id TEXT PRIMARY KEY
      email TEXT

  bleat_db.posts:
      id SERIAL
      author_id TEXT
      content TEXT

  MongoDB:
      db: bleater
      collection: profiles
      field: user_id

  Redis:
      key: session:<USER_ID>

  MinIO:
      endpoint: http://minio:9000
      access_key: minioadmin
      secret_key: minioadmin
      bucket: avatars
      object: <USER_ID>.png

  Available tools:
      psql, mongosh, redis-cli, mc